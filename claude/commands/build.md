---
description: 分解済みタスクを自律実行モードで実装
---

@docs/guides/sub-agents.md を厳守し、**オーケストレーター**として振る舞います。

作業計画書: $ARGUMENTS

## 📋 実行前の前提確認

### タスクファイル存在チェック
```bash
# 計画書の確認
! ls -la docs/plans/*.md | grep -v template | tail -5

# タスクファイルの確認
! ls docs/plans/tasks/*.md 2>/dev/null || echo "⚠️ タスクファイルが見つかりません"
```

### タスク生成判定フロー

**Think deeply** タスクファイルの存在状態を確認し、適切な対応を決定：

| 状態 | 判定基準 | 次のアクション |
|------|---------|--------------|
| タスク存在 | tasks/ディレクトリに.mdファイルあり | 自律実行モードへ移行 |
| タスクなし＋計画書あり | 計画書は存在するがタスクファイルなし | ユーザーに確認 → task-decomposer実行 |
| 両方なし | 計画書もタスクファイルもなし | エラー：実行条件を満たさない |

## 🔄 タスク分解フェーズ（条件付き実行）

タスクファイルが存在しない場合の処理：

### 1. ユーザー確認
```
タスクファイルが見つかりません。
作業計画書: docs/plans/[計画書名].md

計画書からタスクを分解して生成しますか？ (y/n): 
```

### 2. タスク分解実行（承認時）
```
@task-decomposer 作業計画書を読み込み、1コミット粒度の独立したタスクに分解：
- 入力: docs/plans/[計画書名].md
- 出力: docs/plans/tasks/配下に個別タスクファイル生成
- 粒度: 1タスク = 1コミット = 独立して実行可能
```

### 3. 生成確認
```bash
# 生成されたタスクファイルを確認
! ls -la docs/plans/tasks/*.md | head -10
```

✅ **推奨**: タスク生成完了後、自動的に自律実行モードへ移行
❌ **避ける**: タスク未生成のまま実装を開始

## 🧠 各タスクでメタ認知
**必須サイクル**: `task-executor → quality-fixer → commit`

タスク開始前に必ず：
1. **rule-advisor実行**: タスクの本質を理解
2. **TodoWrite更新**: 進捗を構造化
3. **構造化レスポンス処理**: `readyForQualityCheck: true` → quality-fixer即実行

**Think deeply** 構造化レスポンスを見落とさず、品質ゲートを確実に通過させます。

承認確認後、自律実行モードを開始。要件変更検知時は即座に停止。

## 出力例
実装フェーズが完了しました。
- タスク分解: docs/plans/tasks/ 配下に生成（実行時のみ）
- 実装されたタスク: [タスク数]件
- 品質チェック: すべて通過
- コミット: [コミット数]件作成

**責務境界**: 本コマンドはタスク分解から実装完了まで担当。